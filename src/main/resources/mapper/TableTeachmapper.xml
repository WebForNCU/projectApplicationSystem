<?xml version="1.0" encoding="UTF-8" ?>
        <!-- resultMap最终还是要将结果映射到pojo上，type就是指定映射到哪一个pojo -->
        <!-- id：设置ResultMap的id -->
<!DOCTYPE mapper
        PUBLIC ".//mybatis.org//DTD MAPPER 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.security.dao.TableTeachDao">

    <resultMap type="com.spring.security.entity.TableTeach" id="queryTableTeachById">
        <!-- 定义主键 ,非常重要。如果是多个字段,则定义多个id -->
        <!-- property：主键在pojo中的属性名 -->
        <!-- column：主键在数据库中的列名 -->
        <id property="id" column="id" />
        <!-- 定义普通属性 -->
        <result property="table_teach_name" column="table_teach_name" />
        <result property="table_name" column="table_name" />
        <result property="table_teacher_describe" column="table_teacher_describe" />
        <result property="table_describe" column="table_describe" />
        <result property="audit" column="audit" />
        <result property="src" column="src" />
        <result property="isfill" column="isfill" />
    </resultMap>

    <select id="queryTableTeachList" resultMap="queryTableTeachById">
        select * from tableteach where table_name= #{table_name}
    </select>

    <select id="queryTableTeachID" resultType="java.lang.Integer">
        select max(id) from tableteach
    </select>

    <insert id="addTableTeach"  keyProperty="id" parameterType="com.spring.security.entity.TableTeach">
        insert into tableteach(table_teach_name,table_name,table_teacher_describe,table_describe,audit,src,isfill) values (#{table_teach_name},#{table_name},#{table_teacher_describe},#{table_describe},#{audit},#{src},#{isfill})
    </insert>

    <select id="queryTableTeachById" resultMap="queryTableTeachById">
        select id,table_teach_name,table_name,table_teacher_describe,table_describe from tableteach where id = #{id}
    </select>

    <select id="queryTableTeachByTableNameAndUserName" resultMap="queryTableTeachById">
        select *from tableteach where table_name=#{table_name} and table_teach_name=#{table_teach_name}
    </select>

    <update id="updateTableTeachDate" parameterType="com.spring.security.entity.TableTeach">
        update tableteach set table_teach_name=#{table_teach_name},table_name=#{table_name},table_teacher_describe=#{table_teacher_describe},table_describe=#{table_describe},isfill=#{isfill} where id=#{id}
    </update>

    <update id="updateFilePath" parameterType="com.spring.security.entity.TableTeach">
        update tableteach set src=#{src} where id=#{id}
    </update>

    <delete id="deleteTableTeach" parameterType="com.spring.security.entity.TableTeach">
        delete from tableteach where table_teach_name=#{table_teach_name}
    </delete>

    <delete id="deleteByBatch" parameterType="com.spring.security.entity.TableTeach">
        DELETE tableteach ,tablename  FROM tableteach,tablename
        WHERE tableteach.table_name = tablename.table_name
        AND tablename.batch_name=#{batch_name};
</delete>

    <select id="queryTableTeachTableName" parameterType="java.lang.String" resultType="java.lang.String">
        select table_name from tableteach where table_teach_name = #{table_teach_name}
    </select>
    <select id="queryTableTeacherDescribeByUserNameAndTablename" parameterType="java.lang.String" resultType="java.lang.String">
        select table_teacher_describe from tableteach where table_teach_name = #{table_teach_name} and table_name =#{table_name }
    </select>

    <select id="queryTableTeacherDescribe" parameterType="java.lang.String" resultType="java.lang.String">
        select table_teacher_describe from tableteach where table_teach_name = #{table_teach_name}
    </select>

    <select id="queryTableNameDescribe" parameterType="java.lang.String" resultType="java.lang.String">
        select table_describe from tableteach where table_teach_name = #{table_teach_name}
    </select>

    <select id="queryTableTeachListByusername" resultMap="queryTableTeachById">
        select * from tableteach where table_teach_name= #{table_teach_name}
    </select>
    <select id="queryTableTeachListByusernameAudited" resultMap="queryTableTeachById">
        select * from tableteach where table_teach_name= #{table_teach_name} and audit=1
    </select>

    <select id="queryTableNameDescribeById" resultType="java.lang.Integer">
        select id from tableteach where table_name = #{table_name} and table_teach_name = #{table_teach_name}
    </select>

    <select id="queryUnaudited" resultMap="queryTableTeachById">
        select * from tableteach where table_name= #{table_name} and audit=0;
    </select>

    <select id="queryAudited" resultMap="queryTableTeachById">
        select * from tableteach where table_name= #{table_name} and audit=1;
    </select>

    <update id="updateIsfill" parameterType="com.spring.security.entity.TableTeach">
        update tableteach set isfill=#{isfill} where id=#{id}
    </update>

    <update id="updateAudit" parameterType="com.spring.security.entity.TableTeach">
        update tableteach set audit=#{audit} where id=#{id}
    </update>

    <update id="audit" parameterType="com.spring.security.entity.TableTeach">
        update tableteach set audit=1 where id=#{id}
    </update>
    <update id="auditAll" parameterType="com.spring.security.entity.TableTeach">
        update tableteach set audit=1 where id in (${str});
    </update>

</mapper>